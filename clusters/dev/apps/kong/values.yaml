kong:
  global:
    imagePullSecrets:
      - docker-registry-secret

  image:
    repository: hdc-services-external/kong-with-oidc
    pullPolicy: IfNotPresent
    debug: false

  database: postgresql
  replicaCount: 1

  ingress:
    enabled: true
    hostname: api.dev.hdc.ebrains.eu
    path: /
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      kubernetes.io/ingress.class: nginx
      nginx.ingress.kubernetes.io/affinity: cookie
      nginx.ingress.kubernetes.io/proxy-body-size: 20m
      nginx.ingress.kubernetes.io/proxy-buffer-size: 512k
      nginx.ingress.kubernetes.io/proxy-buffering: "on"
      nginx.ingress.kubernetes.io/proxy-buffers-number: "8"
      nginx.ingress.kubernetes.io/proxy-connect-timeout: 180s
      nginx.ingress.kubernetes.io/proxy-max-temp-file-size: "0"
      nginx.ingress.kubernetes.io/proxy-read-timeout: 180s
      nginx.ingress.kubernetes.io/proxy-send-timeout: 180s
    tls: true

  ingressController:
    enabled: false

  postgresql:
    enabled: true
    image:
      repository: hdc-services-external/bitnami/postgresql
      tag: "16.3.0-debian-12-r19"
    auth:
      username: kong
      database: kong
      existingSecret: kong-postgresql-credentials
      secretKeys:
        adminPasswordKey: postgres-password
        userPasswordKey: password
    architecture: standalone
    primary:
      persistence:
        enabled: true
        size: 5Gi

  kong:
    extraEnvVars:
      - name: KONG_LOG_LEVEL
        value: "debug"
      - name: KONG_PLUGINS
        value: "bundled,oidc"

  service:
    exposeAdmin: true

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
